{
  "hash": "851f15b74395a10a8e79b19555acb450",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"**Two-Way ANOVA**\"\nsubtitle: \"**STA4173: Biostatistics** <br> Spring 2025\"\nformat: \n  revealjs: \n    code-overflow: wrap\n    df-print: paged\n    embed-resources: true\n    slide-number: true\n    width: 1600\n    height: 900\n    html-math-method: katex\n    theme:\n      - default\nexecute:\n  echo: true\n  warning: false\n  message: false\n  error: true\neditor: source\n---\n\n\n\n## Introduction: Two-Way ANOVA\n\n- Recall that ANOVA allows us to compare the means of three or more groups.\n\n- In one-way ANOVA, we are only considering one factor (grouping variable). \n\n- Now, we will discuss two-way ANOVA, which allows us to consider a second factor (grouping variable). \n\n- We now partition the SS<sub>Trt</sub> into the different factors under consideration.\n    \n- Recall that SS<sub>E</sub> is the \"catch all\" for unexplained variance. \n\n    - When we add factors to our model, we are moving part of the SS<sub>E</sub> into the SS<sub>Trt</sub>.\n    \n## Introduction: Two-Way ANOVA\n\n- Let's discuss some of the language used in two-way ANOVA. \n\n- Factor A has $a$ levels.\n    \n    - Smoking status: non-smoker and smoker\n\n- Factor B has $b$ levels.\n\n    - Hypertension: normotensive and hypertensive\n\n- There are $ab$ treatment groups.\n\n    - Non-smoker, normotensive\n    - Non-smoker, hypertensive\n    - Smoker, normotensive\n    - Smoker, hypertensive\n\n## Introduction: Two-Way ANOVA\n\n- Now that we are including two factors, we must consider the interaction between the two. \n\n    - *Interaction*: The relationship between [outcome] and [factor 1] depends on the level of [factor 2].\n\n- In our example, suppose we are looking at weight as the outcome. If an interaction is detected,\n\n    - the relationship between weight and hypertension status depends on smoking status, OR\n    - the relationship between weight and smoking status depends on hypertension status. \n\n## Introduction: Two-Way ANOVA\n\n- The ANOVA table that we are working to construct: \n\n| **Source** | **Sum of Squares** | **df** | **Mean Square** | ***F*** |\n|-|-|-|-|-|\nA | SS<sub>A</sub> | df<sub>A</sub> | MS<sub>A</sub> | *F*<sub>A</sub>\nB | SS<sub>B</sub> | df<sub>B</sub> | MS<sub>B</sub> | *F*<sub>B</sub>\nAB | SS<sub>AB</sub> | df<sub>AB</sub> | MS<sub>AB</sub> | *F*<sub>AB</sub>\nError | SS<sub>E</sub> | df<sub>E</sub> | MS<sub>E</sub> |\nTotal | SS<sub>Tot</sub> | df<sub>Tot</sub> | | |   \n\n## Computation\n\n- Let there be $a$ levels of factor A and $b$ levels of factor B. \n\n    - $y_{ijk}$ is the observation on the $k^{th}$ experimental unit receiving the $i^{th}$ level of factor A and the $j^{th}$ level of factor B \n    - $y_{i.}$ is the sum for all observations at the $i^{th}$ level of factor A,\n    - $y_{.j}$ is the sum for all observations at the $j^{th}$ level of factor B,\n    - $y_{ij}$ is the sum for observations at the $i^{th}$ level of factor A and the $j^{th}$ level of factor B,\n    - $y_{..}$ is the sum of all observations, \n    - $(y^2)_{..}$ is the sum of the squared observations, \n    - $n$ is the number in each group (of $a \\times b$ treatments)\n\n## Computation\n\n- To find the SS and df:\n$$\n\\begin{align*}\n\\text{SS}_{\\text{A}} &= \\frac{\\sum_i y_{i.}^2}{bn}  - \\frac{(y_{..})^2}{abn} & \\text{df}_{\\text{A}} &= a-1 \\\\\n\\text{SS}_{\\text{B}} &= \\frac{\\sum_j y_{.j}^2}{an} - \\frac{(y_{..})^2}{abn} & \\text{df}_{\\text{B}} &= b-1 \\\\\n\\text{SS}_{\\text{AB}}&= \\frac{\\sum_{ij} y_{ij}^2}{n} - \\frac{(y_{..})^2}{abn} - \\text{SS}_{\\text{A}} - \\text{SS}_{\\text{B}} & \\text{df}_{\\text{AB}} &= (a-1)(b-1) \\\\\n\\text{SS}_{\\text{E}} &= \\text{SS}_{\\text{Tot}} - \\text{SS}_{\\text{A}} - \\text{SS}_{\\text{B}} - \\text{SS}_{\\text{AB}} & \\text{df}_{\\text{E}} &= ab(n-1)  \\\\\n\\text{SS}_{\\text{Tot}} &= (y^2)_{..} - \\frac{(y_{..})^2}{abn} & \\text{df}_{\\text{Tot}} &= abn-1\n\\end{align*}  \n$$  \n\n## Computation\n\n- To find the MS:\n\n$$\\text{MS}_{\\text{X}} = \\frac{\\text{SS}_{\\text{X}}}{\\text{df}_{\\text{X}}}$$\n\n- To find the test statistic:\n\n$$\\text{F}_{\\text{X}} = \\frac{\\text{MS}_{\\text{X}}}{\\text{MS}_{\\text{E}}}$$\n\n## R Syntax\n\n- We will again use `lm()` and `anova()` OR `aov()` and `summary()` to analyze the data.\n\n    - For reasons covered in one-way ANOVA, we will focus on using `aov()`.\n\n- As we are specifying our model, we will:\n    - include additional terms with +\n    - include interaction terms with :\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- aov(continuous_variable ~ factor_A + factor_B + factor_A:factor_B,\n         data = dataset_name)\nsummary(m)\n```\n:::\n\n\n\n## Example\n\n- Suppose we want to examine the effect of diet and age of mothers on the average birth weight (in ounces). Consider the following data,\n\n<center><img src=\"images/L12a.png\"></center>\n\n- What is the outcome? \n- What are the two factors? \n- What is the interaction term?\n\n## Example\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nexample <- tibble(birthweight = c(157.78, 136.79, 138.84, # age 20-29, diet 1\n                                  139.72, 125.47, 117.14, # age 20-29, diet 2\n                                  129.35, 110.73, 118.38, # age 20-29, diet 3\n                                  137.07, 146.28, 130.27, # age 30-39, diet 1\n                                  117.46, 128.54, 99.16, # age 30-39, diet 2\n                                  97.43, 125.26, 115.42), # age 30-39, diet 3\n                  diet = as.factor(c(1, 1, 1, \n                                     2, 2, 2, \n                                     3, 3, 3, \n                                     1, 1, 1, \n                                     2, 2, 2, \n                                     3, 3, 3)),\n                  age = as.factor(c(20, 20, 20, \n                                    20, 20, 20, \n                                    20, 20, 20, \n                                    30, 30, 30, \n                                    30, 30, 30, \n                                    30, 30, 30)))\n```\n:::\n\n\n\n## Example\n\n- Let's find the ANOVA table,\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- aov(birthweight ~ diet + age + diet:age, data = example)\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value  Pr(>F)   \ndiet         2 2104.7  1052.3   7.555 0.00752 **\nage          1  332.0   332.0   2.384 0.14855   \ndiet:age     2   32.5    16.3   0.117 0.89083   \nResiduals   12 1671.5   139.3                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n## Testing Interactions\n\n- **Hypotheses**\n\n    - $H_0:$ there is not an interaction between [factor A] and [factor B]\n    - $H_1:$ there is an interaction between [factor A] and [factor B]\n\n- **Test Statistic and *p*-Value**\n\n    - $F_{\\text{AB}}$ (pull from ANOVA table)\n    - $p = P[F_{\\text{df}_{\\text{AB}}, \\text{df}_{\\text{E}}} \\ge F_{\\text{AB}}]$\n\n- **Rejection Region**\n\n    - Reject $H_0$ if $p<\\alpha$.\n    \n## Example\n\n- Let's now test the interaction between age and diet. Test at the $\\alpha=0.05$ level.\n\n- Here's the information we need:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value  Pr(>F)   \ndiet         2 2104.7  1052.3   7.555 0.00752 **\nage          1  332.0   332.0   2.384 0.14855   \ndiet:age     2   32.5    16.3   0.117 0.89083   \nResiduals   12 1671.5   139.3                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n## Example\n\n- **Hypotheses**\n\n    - $H_0:$ there is not an interaction between age and diet\n    - $H_1:$ there is an interaction between age and diet\n\n- **Test Statistic**\n\n    - $F_{\\text{AB}} = 0.117$\n    - $p = 0.891$\n\n- **Rejection Region**\n\n    - Reject $H_0$ if $p<\\alpha$; $\\alpha=0.05$.\n    \n- **Conclusion/Interpretation**\n\n    - Fail to reject $H_0$. There is not sufficient evidence to suggest that the relationship between average birth weight and age depends on the mother's diet. \n\n## Testing Interactions\n\n- What happens after testing for an interaction? \n\n    - If significant (reject $H_0$), we can:\n    \n        - Construct a profile plot to visualize what's going on and help explain the effect. \n        - Examine posthoc testing to further examine the interaction.\n    \n    - If not significant (FTR $H_0$), we should remove the interaction term so that we can test and interpret the main effects.\n\n- Remember that we cannot look at main effects (A and B alone) when the interaction is included in the model!\n\n## Removing Interactions\n\n- If the interaction term is not significant, it should be removed from the ANOVA table so that we can test and interpret the main effects. \n\n- How to remove an interaction:\n\n    1. Rewrite ANOVA table without interaction; do not change SS, df, and MS for the main effects and total.\n    2. Update the error term: add the SS$_{\\text{AB}}$ to SS$_{\\text{E}}$ and df$_{\\text{AB}}$ to df$_{\\text{E}}$.\n    3. Recalculate MS$_{\\text{E}}$.\n    4. Recalculate $F$ statistics for the main effects and perform appropriate hypothesis tests.\n    \n- In R, we just literally remove the interaction term.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- aov(continuous_variable ~ factor_A + factor_B,\n         data = dataset_name)\nsummary(m)\n```\n:::\n\n\n\n## Example\n\n- Let's now remove the interaction between diet and maternal age.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#m <- aov(birthweight ~ diet + age + diet:age, data = example)\nm <- aov(birthweight ~ diet + age, data = example)\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value  Pr(>F)   \ndiet         2   2105  1052.3   8.646 0.00359 **\nage          1    332   332.0   2.728 0.12085   \nResiduals   14   1704   121.7                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n## Testing Main Effects\n\n- Now that we have removed the interaction term, we can test for main effects. \n\n- **Hypotheses**\n\n    - $H_0:$ there is not a main effect of [factor X]\n    - $H_1:$ there not a main effect of [factor X]\n\n- **Test Statistic and *p*-Value**\n\n    - $F_{\\text{X}}$ (pull from ANOVA table)\n    - $p = P[F_{\\text{df}_{\\text{X}}, \\text{df}_{\\text{E}}} \\ge F_{\\text{X}}]$\n\n- **Rejection Region**\n\n    - Reject $H_0$ if $p<\\alpha$.\n\n## Testing Main Effects\n\n- A note on hypotheses -- we are writing them in sentence form here, however, we can write them mathematically.\n\n- For Factor A with $a$ levels,\n\n    - $H_0: \\mu_1 = \\mu_2 = ... = \\mu_a$ \n    - $H_1:$ at least one is different\n\n- For Factor B with $b$ levels,\n\n    - $H_0: \\mu_1 = \\mu_2 = ... = \\mu_b$ \n    - $H_1:$ at least one is different\n\n## Example\n\n- We now want to determine if there are main effects of age and diet. Test at the $\\alpha=0.05$ level.\n\n- The ANOVA table without the interaction term:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value  Pr(>F)   \ndiet         2   2105  1052.3   8.646 0.00359 **\nage          1    332   332.0   2.728 0.12085   \nResiduals   14   1704   121.7                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n## Example\n\n- **Hypotheses**\n\n    - $H_0:$ there is not a main effect of diet ($\\mu_1 = \\mu_2 = \\mu_3$)\n    - $H_1:$ there is a main effect of diet (at least one $\\mu_i$ is different)\n\n- **Test Statistic and *p*-Value**\n\n    - $F_{\\text{diet}} = 8.646$ \n    - $p = 0.004$\n\n- **Rejection Region**\n\n    - Reject $H_0$ if $p<\\alpha$; $\\alpha=0.05$.\n\n- **Conclusion/Interpretation**\n    \n    - Reject $H_0$. There is sufficient evidence to suggest that at least one diet reults in a different birth weight.\n    \n## Example\n\n- **Hypotheses**\n\n    - $H_0:$ there is not a main effect of age ($\\mu_1 = \\mu_2$)\n    - $H_1:$ there is a main effect of age ($\\mu_1 \\ne \\mu_2$)\n\n- **Test Statistic and *p*-Value**\n\n    - $F_{\\text{age}} = 2.728$ \n    - $p = 0.121$\n\n- **Rejection Region**\n\n    - Reject $H_0$ if $p<\\alpha$; $\\alpha=0.05$.\n\n- **Conclusion/Interpretation**\n    \n    - Fail to reject $H_0$. There is not sufficient evidence to suggest that there is a difference in birth weights across the age groups.\n\n## Introduction: Beyond the *F* Test \n\n- In this lecture, we are discussing two-way ANOVA.\n\n- So far, we have learned how to:\n\n    - Create an ANOVA model with an interaction term\n    - Test the interaction term\n    - Create an ANOVA model without an interaction term\n    - Test the main effects\n    \n- Now we will learn how to best communicate results, whether it's the resulting interaction term or main effects.\n\n## Profile Plots\n\n- If we detect an interaction term, we must give meaning to it.\n\n- An easy way to do this is to plot the treatment group means to visualize the interaction. This is called a profile plot.\n\n    - *y*-axis: always the average outcome\n    \n    - *x*-axis: either factor A or B\n    \n        - if only one factor is ordinal, use it for the *x*-axis\n        \n        - if there are two ordinal or two nominal factors, select the factor with the largest number of levels for the *x*-axis\n        \n    - lines on the plot: the factor that was not selected for the *x*-axis\n    \n- Note that this is just a graph of the means -- it's valid to construct a profile plot even if the interaction is not sigificant.\n\n## Example\n\n- Let's first find the treatment means for the birth weight data,\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmeans <- example %>%\n  group_by(diet, age) %>%\n  summarize(mean = mean(birthweight)) %>%\n  ungroup()\nhead(means)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"diet\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"age\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"mean\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"20\",\"3\":\"144.4700\"},{\"1\":\"1\",\"2\":\"30\",\"3\":\"137.8733\"},{\"1\":\"2\",\"2\":\"20\",\"3\":\"127.4433\"},{\"1\":\"2\",\"2\":\"30\",\"3\":\"115.0533\"},{\"1\":\"3\",\"2\":\"20\",\"3\":\"119.4867\"},{\"1\":\"3\",\"2\":\"30\",\"3\":\"112.7033\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n## Example\n\n- The average birth weight will go on our *y*-axis.\n\n- Because only maternal age is ordinal, it will go on our *x*-axis.\n\n- Thus, the lines will represent the diet\n\n    - This means I want to restructure the dataset with the means to have a column for each of the diets\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nA <- means %>% filter(diet == 1) %>% rename(d1 = mean) %>% select(-diet)\nB <- means %>% filter(diet == 2) %>% rename(d2 = mean) %>% select(-diet)\nC <- means %>% filter(diet == 3) %>% rename(d3 = mean) %>% select(-diet)\ngraph <- full_join(A, B, by = \"age\")\ngraph <- full_join(graph, C, by = \"age\")\n```\n:::\n\n\n\n## Example\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraph\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"age\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"d1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"d2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"d3\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"20\",\"2\":\"144.4700\",\"3\":\"127.4433\",\"4\":\"119.4867\"},{\"1\":\"30\",\"2\":\"137.8733\",\"3\":\"115.0533\",\"4\":\"112.7033\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n## Example\n\n- Building profile plots using `ggplot()` is a process.\n\n    - First, include a `geom_line()` for each level of the factor creating the lines.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraph %>% \n  ggplot(aes(x = age, group = 1)) +\n  geom_line(aes(y = d1), color = \"pink\") + # diet 1\n  geom_line(aes(y = d2), color = \"purple\") + # diet 2\n  geom_line(aes(y = d3), color = \"blue\") + # diet 3\n  theme_bw()\n```\n:::\n\n\n\n## Example\n\n- Building profile plots using `ggplot()` is a process.\n\n    - First, include a `geom_line()` for each level of the factor creating the lines.\n\n<center>\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](W07-L2-two-way-ANOVA_files/figure-revealjs/unnamed-chunk-12-1.png){width=960}\n:::\n:::\n\n\n</center>\n\n## Example\n\n- Building profile plots using `ggplot()` is a process.\n\n    - Then, add `geom_text()` to label each line (use the line colors to make sure everything is labeled properly).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraph %>% \n  ggplot(aes(x = age, group = 1)) +\n  geom_line(aes(y = d1), color = \"pink\") + # diet 1\n  geom_line(aes(y = d2), color = \"purple\") + # diet 2\n  geom_line(aes(y = d3), color = \"blue\") + # diet 3 \n  geom_text(aes(x = \"30\" , y = 137, label = \"Diet 1\"), color = \"pink\")  + # diet 1\n  geom_text(aes(x = \"30\" , y = 115, label = \"Diet 2\"), color = \"purple\")  + # diet 2\n  geom_text(aes(x = \"30\" , y = 110, label = \"Diet 3\"), color = \"blue\")  + # diet 3\n  theme_bw()\n```\n:::\n\n\n\n## Example\n\n- Building profile plots using `ggplot()` is a process.\n\n    - Then, add `geom_text()` to label each line (use the line colors to make sure everything is labeled properly).\n\n<center>\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](W07-L2-two-way-ANOVA_files/figure-revealjs/unnamed-chunk-14-1.png){width=960}\n:::\n:::\n\n\n</center>\n\n## Example\n\n- Building profile plots using `ggplot()` is a process.\n\n    - Then, clean up time: fix axis titles and change line colors to black*\n    \n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraph %>% \n  ggplot(aes(x = age, group = 1)) +\n  geom_line(aes(y = d1), color = \"black\") + # diet 1\n  geom_line(aes(y = d2), color = \"black\") + # diet 2\n  geom_line(aes(y = d3), color = \"black\") + # diet 3+ \n  geom_text(aes(x = \"30\" , y = 137, label = \"Diet 1\"), color = \"black\")  + # diet 1\n  geom_text(aes(x = \"30\" , y = 115, label = \"Diet 2\"), color = \"black\")  + # diet 2\n  geom_text(aes(x = \"30\" , y = 110, label = \"Diet 3\"), color = \"black\")  + # diet 3\n  labs(x = \"Maternal Age\",\n       y = \"Average Birth Weight\") +\n  theme_bw()\n```\n:::\n\n\n\n## Example\n\n<center>\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](W07-L2-two-way-ANOVA_files/figure-revealjs/unnamed-chunk-16-1.png){width=960}\n:::\n:::\n\n\n</center>\n\n\n\n## Posthoc Tests\n\n- We can also apply posthoc testing to two-way ANOVA.\n\n    - If the interaction is significant, we can compare all treatment groups.\n    \n    - If the interaction is not significant, we can look at the main effects.\n    \n- For simplicity, we will only look at Tukey's and Fisher's.\n\n- What is the difference between Tukey's and Fisher's?\n    \n    \n## Example\n\n- Let's apply Tukey's to the model with the interaction term.\n\n    - **Important!!** Remember that we are only doing this for illustration purposes - we should not perform posthoc testing on something non-significant.\n    \n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- aov(birthweight ~ diet + age + diet:age, data = example)\nTukeyHSD(m)$\"diet:age\"\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                diff       lwr       upr      p adj\n2:20-1:20 -17.026667 -49.39499 15.341659 0.51846118\n3:20-1:20 -24.983333 -57.35166  7.384992 0.17257865\n1:30-1:20  -6.596667 -38.96499 25.771659 0.98037295\n2:30-1:20 -29.416667 -61.78499  2.951659 0.08309462\n3:30-1:20 -31.766667 -64.13499  0.601659 0.05550164\n3:20-2:20  -7.956667 -40.32499 24.411659 0.95688090\n1:30-2:20  10.430000 -21.93833 42.798326 0.87931551\n2:30-2:20 -12.390000 -44.75833 19.978326 0.78717713\n3:30-2:20 -14.740000 -47.10833 17.628326 0.65386678\n1:30-3:20  18.386667 -13.98166 50.754992 0.44210449\n2:30-3:20  -4.433333 -36.80166 27.934992 0.99674874\n3:30-3:20  -6.783333 -39.15166 25.584992 0.97786517\n2:30-1:30 -22.820000 -55.18833  9.548326 0.24087234\n3:30-1:30 -25.170000 -57.53833  7.198326 0.16754036\n3:30-2:30  -2.350000 -34.71833 30.018326 0.99984711\n```\n\n\n:::\n:::\n\n\n\n## Example\n\n- Let's apply Tukey's to the model without the interaction term.\n    \n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- aov(birthweight ~ diet + age, data = example)\nTukeyHSD(m)$diet\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          diff       lwr       upr      p adj\n2-1 -19.923333 -36.59450 -3.252169 0.01902981\n3-1 -25.076667 -41.74783 -8.405502 0.00397944\n3-2  -5.153333 -21.82450 11.517831 0.70372399\n```\n\n\n:::\n:::\n\n\n\n- Which diets are significantly different? Use $\\alpha=0.05$.\n\n## Wrap Up\n\n- We did not explicitly discuss assumptions, but they are the same as in one-way ANOVA.\n\n- From here, ANOVA can be used to specify any model.\n\n    - We stopped with two-way interactions, but you could have three-way interactions, four-way interactions, etc.\n    \n    - As you can see, interactions quickly complicate the interpretation, so I try to stay away from anything higher than a two-way interaction.\n    \n- Our next module is regression analysis, which is the *same* as ANOVA, but represents the results differently.\n\n    - We can quantify the relationship between two variables using regression.",
    "supporting": [
      "W07-L2-two-way-ANOVA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}