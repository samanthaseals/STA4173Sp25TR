{
  "hash": "3ff564e8851e22b33752e16146287eff",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"**Dependent *t*-Tests**\"\nsubtitle: \"**STA4173: Biostatistics** <br> Spring 2025\"\nformat: \n  revealjs: \n    code-overflow: wrap\n    df-print: paged\n    embed-resources: true\n    slide-number: true\n    width: 1600\n    height: 900\n    html-math-method: katex\n    theme:\n      - default\nexecute:\n  echo: true\n  warning: false\n  message: false\n  error: true\neditor: source\n---\n\n\n\n## **Introduction**\n\n- In the last lecture, we reviewed statistical inference on two independent means.\n    \n    - CI for $\\mu_1-\\mu_2$\n    - Hypothesis test for $\\mu_1-\\mu_2$ (two-sample *t*-test)\n\n- Today, we will focus on drawing *conclusions* about two dependent means.\n\n    - CI for $\\mu_d = \\mu_1-\\mu_2$\n    - Hypothesis test for $\\mu_d = \\mu_1-\\mu_2$ (paired *t*-test)\n\n## **Independent vs. Dependent Data**\n\n::: {.callout type='example'}\n## Independent data \nAn individual selected for one sample does not dictate which individual is to be in a second sample.\n\nIn the data, there is not a way to link the individuals in the sample.\n:::\n\n::: {.callout type='example'}\n## Dependent data \nAn individual selected to be in one sample is used to determine the individual in the second sample.\n\nIn the data, there is a way to link the individuals in the sample.\n:::\n\n- Examples:\n    - Two sections of STA4173\n    - Project grades in one section of STA4173\n    - Male and female penguins\n    - Prices online vs. in store at Target\n\n## **Estimating the Difference Between Two Dependent Means**\n\n-   We are now interested in comparing two **dependent** groups.\n\n-   We assume that the two groups come from the same population and are going to examine the difference,\n\n$$\nd = y_{i, 1} - y_{i, 2}\n$$\n\n-   After drawing samples, we have the following,\n    -   $\\bar{d}$ estimates $\\mu_d$,\n    -   $s^2_d$ estimates $\\sigma^2_d$, and\n    -   $n$ is the sample size.\n\n## **CI for the Difference Between Two Dependent Means**\n\n::: {.callout type='example'}\n## $\\mathbf{(1-\\boldsymbol\\alpha)100\\%}$ confidence interval for $\\mathbf{\\boldsymbol\\mu_d}$\n\n$$ \\bar{d} \\pm t_{\\alpha/2} \\frac{s_d}{\\sqrt{n}} $$\n\n-   where $t_{\\alpha/2}$ has $n-1$ degrees of freedom.\n-   To construct this interval, we require either:\n    -   the differences to be normally distributed or\n    -   the sample size is sufficiently large ($n \\ge 30$)\n\n:::\n\n- `R` syntax:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(dataset_name$variable1_name,\n       dataset_name$variable2_name, \n       paired = TRUE, \n       conf.level = confidence_level)\n```\n:::\n\n\n\n## **CI for the Difference Between Two Dependent Means**\n\n-   Insurance adjusters are concerned about the high estimates they are receiving for auto repairs from garage I compared to garage II.\n-   15 cars were taken to both garages for separate estimates of repair costs.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\ngarage <- tibble(g1 = c(17.6, 20.2, 19.5, 11.3, 13.0, \n                        16.3, 15.3, 16.2, 12.2, 14.8,\n                        21.3, 22.1, 16.9, 17.6, 18.4), \n                 g2 = c(17.3, 19.1, 18.4, 11.5, 12.7, \n                        15.8, 14.9, 15.3, 12.0, 14.2, \n                        21.0, 21.0, 16.1, 16.7, 17.5))\n```\n:::\n\n\n\n-   Construct the 95% confidence interval for the average difference between the two garages.\n\n- Remember the `R` syntax:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(dataset_name$variable1_name,\n       dataset_name$variable2_name, \n       paired = TRUE, \n       conf.level = confidence_level)\n```\n:::\n\n\n\n\n## **CI for the Difference Between Two Dependent Means**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(garage$g1, \n       garage$g2, \n       paired = TRUE, \n       conf.level = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPaired t-test\n\ndata:  garage$g1 and garage$g2\nt = 6.0234, df = 14, p-value = 3.126e-05\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n 0.3949412 0.8317254\nsample estimates:\nmean difference \n      0.6133333 \n```\n\n\n:::\n:::\n\n\n\n-   The 95% CI for $\\mu_d$, where $d = x_{\\text{I}} - x_{\\text{II}}$ is (0.39, 0.83).\n\n-   From the problem statement:\n    - *Insurance adjusters are concerned about the high estimates they are receiving for auto repairs from garage I compared to garage II.*\n-   Can we say that estimates from garage I are higher than those from garage II?\n\n## **Paired *t*-Test for Two Dependent Means**{.smaller}\n\n**Hypotheses**\n\n- $H_0:$ $\\mu_d = \\mu_0$ $|$ $H_0:$ $\\mu_d \\le \\mu_0$ | $H_0:$ $\\mu_d \\ge \\mu_0$\n- $H_1:$ $\\mu_d \\ne \\mu_0$ | $H_1:$ $\\mu_d > \\mu_0$ | $H_1:$ $\\mu_d < \\mu_0$ \n\n**Test Statistic & *p*-Value**\n\n- $t_0 = \\frac{\\bar{d}-\\mu_0}{\\frac{s_d}{\\sqrt{n}}}$\n- $p = 2 P[t \\ge |t_0|]$ | $p = P[t \\ge |t_0|]$ | $p = P[t \\le |t_0|]$\n\n**Rejection Region**\n\n- Reject $H_0$ if $p < \\alpha$.\n\n**Conclusion/Interpretation**\n\n- [Reject or fail to reject] $H_0$.\n\n- There [is or is not] sufficient evidence to suggest [alternative hypothesis in words].\n\n\n\n## **Paired *t*-Test**\n\n- R syntax:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(dataset_name$variable1_name, \n       dataset_name$variable2_name, \n       paired = TRUE, \n       mu = hypothesized_difference,\n       alternative = \"alternative\")\n```\n:::\n\n\n\n- Important!!\n    - We are estimating $\\mu_1 - \\mu_2$, but R is going to subtract in the order we state in the `t.test()` function.\n\n## **Paired *t*-Test: Example**\n\n-   Let's now formally determine if garage I's estimates are higher than garage II's. Test at the $\\alpha=0.05$ level.\n\n- Recall the data,\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarage <- tibble(g1 = c(17.6, 20.2, 19.5, 11.3, 13.0, \n                        16.3, 15.3, 16.2, 12.2, 14.8,\n                        21.3, 22.1, 16.9, 17.6, 18.4), \n                 g2 = c(17.3, 19.1, 18.4, 11.5, 12.7, \n                        15.8, 14.9, 15.3, 12.0, 14.2, \n                        21.0, 21.0, 16.1, 16.7, 17.5))\n```\n:::\n\n\n\n- and the `R` syntax:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(dataset_name$variable1_name, \n       dataset_name$variable2_name, \n       paired = TRUE, \n       mu = hypothesized_difference,\n       alternative = \"alternative\")\n```\n:::\n\n\n\n## **Paired *t*-Test: Example**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(garage$g1, \n       garage$g2,\n       paired = TRUE,\n       mu = 0,\n       alternative = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPaired t-test\n\ndata:  garage$g1 and garage$g2\nt = 6.0234, df = 14, p-value = 1.563e-05\nalternative hypothesis: true mean difference is greater than 0\n95 percent confidence interval:\n 0.4339886       Inf\nsample estimates:\nmean difference \n      0.6133333 \n```\n\n\n:::\n:::\n\n\n\n- Are the estimates from garage I significantly higher than those from garage II?\n\n## **Paired *t*-Test: Example**{.smaller}\n\n**Hypotheses**\n\n-   $H_0: \\ \\mu_{\\text{I}} \\le \\mu_{\\text{II}}$ OR $\\mu_{d} \\le 0$, where $\\mu_d = \\mu_{\\text{I}} - \\mu_{\\text{II}}$\n-   $H_1: \\ \\mu_{\\text{I}} > \\mu_{\\text{II}}$ OR $\\mu_{d} > 0$\n\n**Test Statistic and *p*-Value**\n\n- $t_0 = 6.023$\n- $p < 0.001$\n\n**Rejection Region**\n\n- Reject $H_0$ if $p < \\alpha$; $\\alpha = 0.05$.\n\n**Conclusion/Interpretation**\n\n- Reject $H_0$.\n- There is sufficient evidence to suggest the estimates at garage I are higher than that of garage II.\n\n## **Wrap Up**\n\n- Today we reviewed the dependent *t*-test.\n    - Confidence intervals\n    - Hypothesis testing\n\n- Next lectures:\n    - Assumptions on *t*-tests.\n    - Wilcoxon rank sum\n    - Wilcoxon signed rank",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}